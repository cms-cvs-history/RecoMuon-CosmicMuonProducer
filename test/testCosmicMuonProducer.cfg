process MuonC = {

   include "RecoTracker/SingleTrackPattern/test/services.cfi"
   #include "RecoMuon/CosmicMuonProducer/test/cosmicSource.cfi"
   include "RecoTracker/SingleTrackPattern/test/cosmicGen.cfi"

   include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"

   #Magnetic Field
   include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

   #non-beam Oscar Producer 
   include "RecoTracker/SingleTrackPattern/test/nonbeamOscarProducer.cfi"

   # Digitization of the simulated hits

   # CSC
   include "Geometry/CSCGeometry/data/cscGeometry.cfi"
   include "SimMuon/CSCDigitizer/data/muoncscdigi.cfi"

   # DT
   include "Geometry/DTGeometry/data/dtGeometry.cfi"
   include "SimMuon/DTDigitizer/data/muondtdigi.cfi"

   # Mixing Module is *required* to simulated Ecal/Hcal/Muon digitization !

   module mix = MixingModule
   {
      int32 bunchspace = 25
   }

#
# Muon Segments
#
   ## CSC
   include "RecoLocalMuon/CSCRecHit/data/CSCRecHit2DProducer.cfi"
   include "RecoLocalMuon/CSCSegment/data/CSCSegmentProducer.cfi"

   ## DT
   include "RecoLocalMuon/DTRecHit/data/DTRecHit1DProducer_ParamDrift.cfi"
   include "RecoLocalMuon/DTSegment/data/DTSegment2DProducer_CombPatternReco2D_ParamDrift.cfi"
   include "RecoLocalMuon/DTSegment/data/DTSegment4DProducer_CombPatternReco4D_ParamDrift.cfi"

   ## Geometry
   include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"

   es_module = MuonDetLayerGeometryESProducer { }

   ## Propagator
   include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagatorAny.cfi"

   ## Estimator
 #  include "TrackingTools/KalmanUpdators/data/Chi2MeasurementEstimatorESProducer.cfi"

   include "RecoMuon/MuonSeedGenerator/data/CosmicMuonSeedProducer.cfi"
   include "RecoMuon/CosmicMuonProducer/data/CosmicMuonProducer.cfi"

   # Output module
   #
   module output = PoolOutputModule
   {
      untracked string fileName = "/tmp/MCCosMuons.root"
   }
   # Now order modules for execution
   #
   sequence muonDigi = { muonCSCDigis & muonDTDigis }

   sequence muonReco = {csc2DRecHits & cscSegments & dt1DRecHits & dt2DSegments & dt4DSegments }

   path p1 = {g4SimHits, mix, muonDigi, muonReco, CosmicMuonSeed, CosmicMuon}
   endpath outpath = { output }

}
