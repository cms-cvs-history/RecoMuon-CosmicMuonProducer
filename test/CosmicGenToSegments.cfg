process Prod1 = {

   service = Timing {}

   service = RandomNumberGeneratorService
   {
      untracked uint32 sourceSeed = 135799753
      PSet moduleSeeds =
      {
         untracked uint32 VtxSmeared = 123456789
      }
   }


   source = CosMuoGenSource {
     untracked int32  maxEvents = 1000
     untracked double MinEn =    2.
     untracked double MaxEn =   10000
     untracked double MinTheta =  0.
     untracked double MaxTheta = 88.
     untracked double MinPhi =    0.
     untracked double MaxPhi =  360.
     untracked double MinT0  =  -12.5
     untracked double MaxT0  =   12.5
     untracked double ElossScaleFactor = 0.0
     #WARNING: If "TrackerOnly=true" then tracker-only setup will be used. 
     #This means R=1100 and Z=1100, no material or B-field outside is considered
     untracked bool TrackerOnly = true
     untracked bool Verbosity = false
   }

   include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
   include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"

   #Magnetic Field
   include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

   #non-beam Oscar Producer 
   include "RecoTracker/SingleTrackPattern/test/nonbeamOscarProducer.cfi"

   # Digitization of the simulated hits

   # CSC
   include "Geometry/CSCGeometry/data/cscGeometry.cfi"
   include "SimMuon/CSCDigitizer/data/muoncscdigi.cfi"

   # DT
   include "Geometry/DTGeometry/data/dtGeometry.cfi"
   include "SimMuon/DTDigitizer/data/muondtdigi.cfi"

   # Mixing Module is *required* to simulated Ecal/Hcal/Muon digitization !

   module mix = MixingModule
   {
      int32 bunchspace = 25
   }

#
# Muon Segments
#
   ## CSC
   include "RecoLocalMuon/CSCRecHit/data/CSCRecHit2DProducer.cfi"
   include "RecoLocalMuon/CSCSegment/data/CSCSegmentProducer.cfi"

   ## DT
   include "RecoLocalMuon/DTRecHit/data/DTRecHit1DProducer_ParamDrift.cfi"
   include "RecoLocalMuon/DTSegment/data/DTSegment2DProducer_CombPatternReco2D_ParamDrift.cfi"
   include "RecoLocalMuon/DTSegment/data/DTSegment4DProducer_CombPatternReco4D_ParamDrift.cfi"

   # Output module
   #
   module output = PoolOutputModule
   {
      untracked string fileName = "cosSegs.root"
   }
   # Now order modules for execution
   #
   sequence muonDigi = { muonCSCDigis & muonDTDigis }

   sequence muonReco = {csc2DRecHits & cscSegments & dt1DRecHits & dt2DSegments & dt4DSegments }

   path p1 = {g4SimHits, mix, muonDigi, muonReco}
   endpath outpath = { output }

}
